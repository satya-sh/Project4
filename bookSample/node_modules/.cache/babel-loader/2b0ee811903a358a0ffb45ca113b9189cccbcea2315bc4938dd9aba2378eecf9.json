{"ast":null,"code":"import React,{useState,useEffect}from'react';import{initializeApp}from'firebase/app';import{getAuth,onAuthStateChanged,signInWithPopup,GoogleAuthProvider}from'firebase/auth';import axios from'axios';import'./App.css';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function App(){const[userId,setUserId]=useState(null);const[isSignedIn,setIsSignedIn]=useState(false);const[books,setBooks]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[title,setTitle]=useState('');const[author,setAuthor]=useState('');const[year,setYear]=useState('');const[searchAuthor,setSearchAuthor]=useState('');const firebaseConfig={apiKey:\"AIzaSyDA5fETL0mQ5LspBpywgCqdUFCKbLzrfkk\",authDomain:\"filtered-search.firebaseapp.com\",projectId:\"filtered-search\",storageBucket:\"filtered-search.appspot.com\",messagingSenderId:\"579002251149\",appId:\"1:579002251149:web:8d2feccf7ef71957952fc4\",measurementId:\"G-JCRMNNWZC4\"};initializeApp(firebaseConfig);useEffect(()=>{const auth=getAuth();const unsubscribe=onAuthStateChanged(auth,user=>{console.log('Auth state changed:',user);if(user){console.log('User is signed in:',user);setUserId(user.uid);// Use user's UID as the userId\nsetIsSignedIn(true);// Fetch books when the user is signed in\ndisplayAllBooks();}else{console.log('No user is signed in.');setUserId(null);setIsSignedIn(false);setBooks([]);// Clear books when the user signs out\n}});return()=>unsubscribe();},[]);const signInWithGoogle=()=>{const provider=new GoogleAuthProvider();const auth=getAuth();signInWithPopup(auth,provider).then(result=>{console.log(\"Logged In\",result);}).catch(error=>{console.error(error);});};const displayAllBooks=async()=>{try{const response=await axios.get('https://nth-guide-404519.uw.r.appspot.com/findAllBooks');setBooks(response.data);setLoading(false);}catch(error){setError(error.message);setLoading(false);}};const displayUserBooks=async()=>{try{// Use the userId to fetch books entered by the current user\nconst response=await axios.get(\"https://nth-guide-404519.uw.r.appspot.com/findBooksByUserId?userId=\".concat(userId));setBooks(response.data);setLoading(false);}catch(error){setError(error.message);setLoading(false);}};const handleAuthorSearch=async event=>{event.preventDefault();try{const response=await axios.get(\"https://nth-guide-404519.uw.r.appspot.com/findBooksByAuthor?author=\".concat(searchAuthor));setBooks(response.data);setLoading(false);}catch(error){setError(error.message);setLoading(false);}};const handleSubmit=async event=>{event.preventDefault();const postData={title,author,year:parseInt(year,10),userId:userId// NEW: Include userId when posting a new book\n};try{const response=await axios.post('https://nth-guide-404519.uw.r.appspot.com/saveBook',postData);console.log('Response:',response.data);// After posting a new book, refresh the list of all books\ndisplayAllBooks();}catch(error){console.error('Error posting data:',error);}};const signOut=async()=>{const auth=getAuth();try{await auth.signOut();setIsSignedIn(false);setUserId(null);setBooks([]);// Clear the books when the user signs out\n}catch(error){console.error('Error signing out:',error);}};return/*#__PURE__*/_jsx(\"div\",{children:isSignedIn?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Welcome, User \",userId]}),/*#__PURE__*/_jsx(\"button\",{onClick:displayAllBooks,children:\"View All Books\"}),/*#__PURE__*/_jsx(\"button\",{onClick:displayUserBooks,children:\"View Your Books\"})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"sign-in-button\",onClick:signInWithGoogle,children:\"Sign in with Google\"}),/*#__PURE__*/_jsx(\"p\",{className:\"welcome-message\",children:\"Welcome!\"})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","initializeApp","getAuth","onAuthStateChanged","signInWithPopup","GoogleAuthProvider","axios","jsxs","_jsxs","jsx","_jsx","App","userId","setUserId","isSignedIn","setIsSignedIn","books","setBooks","loading","setLoading","error","setError","title","setTitle","author","setAuthor","year","setYear","searchAuthor","setSearchAuthor","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","auth","unsubscribe","user","console","log","uid","displayAllBooks","signInWithGoogle","provider","then","result","catch","response","get","data","message","displayUserBooks","concat","handleAuthorSearch","event","preventDefault","handleSubmit","postData","parseInt","post","signOut","children","onClick","className"],"sources":["/Users/satya/Desktop/spring lab/bookSample/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth, onAuthStateChanged, signInWithPopup, GoogleAuthProvider } from 'firebase/auth';\nimport axios from 'axios';\n\nimport './App.css';\n\nfunction App() {\n  const [userId, setUserId] = useState(null);\n  const [isSignedIn, setIsSignedIn] = useState(false);\n\n  const [books, setBooks] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [title, setTitle] = useState('');\n  const [author, setAuthor] = useState('');\n  const [year, setYear] = useState('');\n  const [searchAuthor, setSearchAuthor] = useState('');\n\n  const firebaseConfig = {\n    apiKey: \"AIzaSyDA5fETL0mQ5LspBpywgCqdUFCKbLzrfkk\",\n    authDomain: \"filtered-search.firebaseapp.com\",\n    projectId: \"filtered-search\",\n    storageBucket: \"filtered-search.appspot.com\",\n    messagingSenderId: \"579002251149\",\n    appId: \"1:579002251149:web:8d2feccf7ef71957952fc4\",\n    measurementId: \"G-JCRMNNWZC4\"\n  };\n\n  initializeApp(firebaseConfig);\n\n  useEffect(() => {\n    const auth = getAuth();\n\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      console.log('Auth state changed:', user);\n\n      if (user) {\n        console.log('User is signed in:', user);\n        setUserId(user.uid); // Use user's UID as the userId\n        setIsSignedIn(true);\n        // Fetch books when the user is signed in\n        displayAllBooks();\n      } else {\n        console.log('No user is signed in.');\n        setUserId(null);\n        setIsSignedIn(false);\n        setBooks([]); // Clear books when the user signs out\n      }\n    });\n  \n    return () => unsubscribe();\n  }, []);\n  \n\n  const signInWithGoogle = () => {\n    const provider = new GoogleAuthProvider();\n    const auth = getAuth();\n    signInWithPopup(auth, provider)\n      .then((result) => {\n        console.log(\"Logged In\", result);\n      })\n      .catch((error) => {\n        console.error(error);\n      });\n  };\n\n  const displayAllBooks = async () => {\n    try {\n      const response = await axios.get('https://nth-guide-404519.uw.r.appspot.com/findAllBooks');\n      setBooks(response.data);\n      setLoading(false);\n    } catch (error) {\n      setError(error.message);\n      setLoading(false);\n    }\n  };\n\n  const displayUserBooks = async () => {\n    try {\n      // Use the userId to fetch books entered by the current user\n      const response = await axios.get(`https://nth-guide-404519.uw.r.appspot.com/findBooksByUserId?userId=${userId}`);\n      setBooks(response.data);\n      setLoading(false);\n    } catch (error) {\n      setError(error.message);\n      setLoading(false);\n    }\n  };\n\n  const handleAuthorSearch = async (event) => {\n    event.preventDefault();\n\n    try {\n      const response = await axios.get(`https://nth-guide-404519.uw.r.appspot.com/findBooksByAuthor?author=${searchAuthor}`);\n      setBooks(response.data);\n      setLoading(false);\n    } catch (error) {\n      setError(error.message);\n      setLoading(false);\n    }\n  };\n\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n\n    const postData = {\n      title,\n      author,\n      year: parseInt(year, 10),\n      userId: userId, // NEW: Include userId when posting a new book\n    };\n\n    try {\n      const response = await axios.post('https://nth-guide-404519.uw.r.appspot.com/saveBook', postData);\n      console.log('Response:', response.data);\n      // After posting a new book, refresh the list of all books\n      displayAllBooks();\n    } catch (error) {\n      console.error('Error posting data:', error);\n    }\n  };\n\n  const signOut = async () => {\n    const auth = getAuth();\n    try {\n      await auth.signOut();\n      setIsSignedIn(false);\n      setUserId(null);\n      setBooks([]); // Clear the books when the user signs out\n    } catch (error) {\n      console.error('Error signing out:', error);\n    }\n  };\n\n  return (\n    <div>\n      {isSignedIn ? (\n        <div>\n          <h1>Welcome, User {userId}</h1>\n\n          {/* NEW: Add buttons to switch between displaying all books and user's books */}\n          <button onClick={displayAllBooks}>View All Books</button>\n          <button onClick={displayUserBooks}>View Your Books</button>\n\n          {/* ... (Existing code) */}\n        </div>\n      ) : (\n        <div>\n          <button className=\"sign-in-button\" onClick={signInWithGoogle}>\n            Sign in with Google\n          </button>\n          <p className=\"welcome-message\">Welcome!</p>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}